"Test while true loop via _execute":
  - do:
      catch: bad_request
      python.execute:
        body:
          script:
            source: "while True:\n  pass"

  - match: { error.root_cause.0.type: "script_exception" }
  - match: { error.root_cause.0.reason: "compile error" }
  - match: { error.caused_by.type: "illegal_argument_exception" }
  - match: { error.caused_by.reason: "no paths escape from while loop" }

---
"Test extraneous while loop via _execute":
  - do:
      catch: bad_request
      python.execute:
        body:
          script:
            source: "while False:\n  pass"

  - match: { error.root_cause.0.type: "script_exception" }
  - match: { error.root_cause.0.reason: "compile error" }
  - match: { error.caused_by.type: "illegal_argument_exception" }
  - match: { error.caused_by.reason: "extraneous while loop" }

---
"Test infinite loop via _execute":
  - do:
      catch: bad_request
      python.execute:
        body:
          script:
            source: "while 1 == 1:\n  pass"

  - match: { error.root_cause.0.type: "script_exception" }
  - match: { error.root_cause.0.reason: "Script execution timed out after 20 seconds" }
